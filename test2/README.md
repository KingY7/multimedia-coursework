# 实验二：基于傅里叶描述子的数字识别

## 实验目的

1. 深入理解傅里叶描述子（Fourier Descriptors）的原理和计算方法
2. 掌握形状特征提取技术在图像识别中的应用
3. 实现基于傅里叶描述子的数字识别系统
4. 对比不同特征提取方法和分类器的性能
5. 理解傅里叶描述子的旋转、缩放、平移不变性

---

## 实验原理

### 1. 傅里叶描述子基本概念

傅里叶描述子是一种强大的形状特征提取方法，通过对轮廓进行傅里叶变换来表示形状特征。

#### 1.1 轮廓表示

将图像轮廓表示为复数序列：
```
z(t) = x(t) + i·y(t)
```
其中 `(x(t), y(t))` 是轮廓上第 `t` 个点的坐标。

#### 1.2 离散傅里叶变换（DFT）

对轮廓序列进行DFT：
```
F(k) = Σ z(t)·e^(-i·2π·k·t/N)
```
其中：
- `F(k)` 是第 `k` 个傅里叶系数
- `N` 是轮廓点的总数
- `k = 0, 1, ..., N-1`

#### 1.3 傅里叶描述子

傅里叶描述子就是傅里叶系数的幅度谱：
```
FD(k) = |F(k)|
```

**关键特性：**
- **低频成分**：描述形状的整体特征
- **高频成分**：描述形状的细节特征
- **不变性**：对旋转、缩放、平移具有不变性

### 2. 不变性实现

#### 2.1 平移不变性
去除DC分量（`F(0) = 0`）或使用归一化处理

#### 2.2 缩放不变性
除以某个参考系数的模值（通常是 `|F(1)|`）

#### 2.3 旋转不变性
只使用傅里叶系数的幅度，忽略相位信息

### 3. 特征匹配

使用欧氏距离、余弦距离或相关系数来度量两个形状的相似度：
```
d = √(Σ (FD1(k) - FD2(k))²)
```

---

## 项目结构

```
实验二/
├── fourier_descriptor.py         # 傅里叶描述子核心实现
├── digit_recognition.py          # 数字识别系统
├── compare_methods.py            # 方法对比实验
├── requirements.txt              # 依赖包列表
├── README.md                     # 实验说明文档
└── results/                      # 实验结果目录
    ├── digit_samples.png         # 数字样本
    ├── fourier_features_comparison.png  # 特征对比
    ├── confusion_matrix.png      # 混淆矩阵
    ├── recognition_examples.png  # 识别示例
    └── method_comparison.png     # 方法对比
```

---

## 环境配置

### 依赖库

- Python >= 3.7
- NumPy >= 1.19.0
- SciPy >= 1.5.0
- OpenCV >= 4.5.0
- scikit-learn >= 0.24.0
- scikit-image >= 0.18.0
- Matplotlib >= 3.3.0
- seaborn >= 0.11.0

### 安装方法

```bash
cd 实验二
pip install -r requirements.txt
```

---

## 使用说明

### 1. 测试傅里叶描述子

```bash
python fourier_descriptor.py
```

**输出：**
- fourier_descriptor_test.png（傅里叶描述子可视化）

### 2. 运行数字识别

```bash
python digit_recognition.py
```

**输出：**
- digit_samples.png（数字样本展示）
- fourier_features_comparison.png（不同数字的特征对比）
- confusion_matrix.png（混淆矩阵）
- recognition_examples.png（识别示例）
- 识别准确率和详细分类报告

### 3. 运行方法对比实验

```bash
python compare_methods.py
```

**输出：**
- method_comparison.png（特征方法和分类器对比）
- 详细的性能对比报告

---

## 数据集说明

本实验使用 **sklearn内置的Digits数据集**：

- **样本数量：** 1797张图像
- **图像尺寸：** 8×8像素（放大到28×28）
- **类别数量：** 10个数字（0-9）
- **数据类型：** 手写数字图像
- **数据来源：** UCI机器学习库

### 数据预处理

1. 图像归一化到0-255
2. 调整大小到28×28像素
3. 应用二值化处理
4. 提取轮廓进行特征提取

---

## 算法实现细节

### 1. 傅里叶描述子提取流程

```python
1. 图像预处理 → 二值化
2. 轮廓提取 → 找到最大外轮廓
3. 轮廓表示 → 转换为复数序列
4. 傅里叶变换 → DFT
5. 归一化处理 → 实现不变性
6. 提取幅度谱 → 傅里叶描述子
7. 保留低频成分 → 降维
```

### 2. 分类器选择

实验中实现了多种分类器：

| 分类器 | 特点 | 适用场景 |
|--------|------|----------|
| K近邻 (KNN) | 简单、直观 | 小规模数据 |
| 支持向量机 (SVM) | 泛化能力强 | 中等规模数据 |
| 决策树 | 可解释性好 | 特征重要性分析 |
| 随机森林 | 集成学习、稳定 | 复杂数据 |

### 3. 性能优化

- 使用NumPy向量化操作加速计算
- 只保留低频傅里叶系数（降维）
- 批量特征提取
- 轮廓点数采样

---

## 实验结果分析

### 预期性能指标

| 指标 | 数值 |
|------|------|
| 识别准确率 | 85-95% |
| 特征维度 | 20-30维 |
| 特征提取速度 | 快 |
| 分类速度 | 快 |

### 傅里叶描述子的优势

1. **维度低**：相比原始像素（784维），傅里叶描述子只需20-30维
2. **不变性**：对旋转、缩放、平移具有鲁棒性
3. **计算快**：FFT算法复杂度为O(N log N)
4. **效果好**：能捕获形状的关键特征

### 与其他方法对比

| 特征方法 | 维度 | 准确率 | 速度 |
|----------|------|--------|------|
| 原始像素 | 784 | 中等 | 慢 |
| 傅里叶描述子 | 30 | 高 | 快 |
| HOG特征 | ~100 | 高 | 中等 |

---

## 可视化说明

### 1. 傅里叶描述子可视化

展示从图像到傅里叶描述子的完整过程：
- 原始图像
- 提取的轮廓
- 傅里叶描述子幅度谱
- 重构轮廓对比

### 2. 特征对比

展示不同数字（0-9）的傅里叶描述子特征差异

### 3. 混淆矩阵

分析哪些数字容易混淆，识别系统的弱点

### 4. 识别示例

展示正确和错误的识别案例

---

## 扩展实验

### 1. 参数调优

- 调整傅里叶描述子数量（n_descriptors）
- 尝试不同的分类器参数
- 实验不同的距离度量方式

### 2. 数据增强

- 添加旋转变换
- 添加缩放变换
- 添加噪声测试鲁棒性

### 3. 实时识别

- 使用摄像头进行实时数字识别
- 优化处理速度

### 4. 自定义数据集

- 使用MNIST完整数据集
- 使用自己手写的数字图像
- 尝试其他形状识别任务

---

## 常见问题

### Q1: 为什么识别率不是100%？

**A:** 
- 数据集中存在书写风格差异大的样本
- 某些数字形状相似（如6和8）
- 傅里叶描述子只保留了低频信息，细节可能丢失

### Q2: 如何提高识别准确率？

**A:**
- 增加傅里叶描述子数量
- 使用更复杂的分类器（SVM、神经网络）
- 结合多种特征
- 增加训练数据

### Q3: 轮廓提取失败怎么办？

**A:**
- 检查图像是否正确二值化
- 调整二值化阈值
- 使用形态学操作（膨胀、腐蚀）优化图像

### Q4: 如何处理不同大小的图像？

**A:**
- 傅里叶描述子本身具有缩放不变性
- 或统一调整图像到相同尺寸

---

## 理论知识点

### 1. 傅里叶变换

傅里叶变换将信号从时域转换到频域，揭示信号的频率成分。

**关键概念：**
- 时域 vs 频域
- 低频 vs 高频
- 幅度谱和相位谱

### 2. 形状描述子

形状描述子是描述形状特征的数值向量。

**常见类型：**
- 全局描述子（如傅里叶描述子）
- 局部描述子（如SIFT、SURF）
- 区域描述子（如Hu矩）

### 3. 不变性

不变性是指特征在某些变换下保持不变。

**类型：**
- 平移不变性
- 旋转不变性
- 缩放不变性
- 反射不变性

---

## 参考文献

[1] Zhang, D., & Lu, G. (2004). Shape-based image retrieval using generic Fourier descriptor. *Signal Processing: Image Communication*, 17(10), 825-848.

[2] Persoon, E., & Fu, K. S. (1977). Shape discrimination using Fourier descriptors. *IEEE Transactions on systems, man, and cybernetics*, 7(3), 170-179.

[3] Zahn, C. T., & Roskies, R. Z. (1972). Fourier descriptors for plane closed curves. *IEEE Transactions on computers*, 100(3), 269-281.

[4] Kuhl, F. P., & Giardina, C. R. (1982). Elliptic Fourier features of a closed contour. *Computer graphics and image processing*, 18(3), 236-258.

---

## 实验报告要求

### 必须包含的内容

1. **实验原理**：详细阐述傅里叶描述子的数学原理
2. **算法实现**：说明关键算法步骤
3. **实验结果**：展示所有生成的可视化结果
4. **性能分析**：分析识别准确率、计算效率等
5. **对比实验**：与其他方法进行对比
6. **问题讨论**：讨论实验中遇到的问题和解决方案
7. **实验总结**：总结收获和改进方向

---

## 作者信息

- **实验名称：** 基于傅里叶描述子的数字识别
- **课程：** 多媒体技术
- **实验编号：** 实验二

---

## 许可证

本实验代码仅供学习和研究使用。
